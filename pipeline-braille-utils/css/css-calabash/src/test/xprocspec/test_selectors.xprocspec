<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.daisy.org/ns/xprocspec"
               xmlns:css="http://www.daisy.org/ns/pipeline/braille-css"
               script="http://www.daisy.org/pipeline/modules/braille/css-calabash/library.xpl">
  
  <!-- ======= -->
  <!-- test_01 -->
  <!-- ======= -->
  <!--
      Universal selector
  -->
  <x:scenario label="test_01">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                * { display: block }
              </style>
            </head>
            <body>
              <h>foo</h>
              <p>foo</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body style="display: block;">
          <h style="display: block;">foo</h>
          <p style="display: block;">foo</p>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_02 -->
  <!-- ======= -->
  <!--
      Type selector
  -->
  <x:scenario label="test_02">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                p { display: block }
              </style>
            </head>
            <body>
              <p>foo</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <p style="display: block;">foo</p>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_03 -->
  <!-- ======= -->
  <!--
      Descendant selector
  -->
  <x:scenario label="test_03">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                section p { display: block }
              </style>
            </head>
            <body>
              <p>foo</p>
              <section>
                <p>foo</p>
              </section>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <p>foo</p>
          <section>
            <p style="display: block;">foo</p>
          </section>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_04 -->
  <!-- ======= -->
  <!--
      Child selector
  -->
  <x:scenario label="test_04">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                section > p { display: block }
              </style>
            </head>
            <body>
              <section>
                <p>foo</p>
                <sidebar>
                  <p>foo</p>
                </sidebar>
              </section>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <section>
            <p style="display: block;">foo</p>
            <sidebar>
              <p>foo</p>
            </sidebar>
          </section>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_05 -->
  <!-- ======= -->
  <!--
      Adjacent selector
  -->
  <x:scenario label="test_05">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                h + p { display: block }
              </style>
            </head>
            <body>
              <h>foo</h>
              <p>foo</p>
              <p>foo</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <h>foo</h>
          <p style="display: block;">foo</p>
          <p>foo</p>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_06 -->
  <!-- ======= -->
  <!--
      Attribute selectors
  -->
  <x:scenario label="test_06">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                [foo] { display: block }
                h[foo] { margin-left: 1 }
                [foo="bar"] { margin-right: 1 }
                [foo~="bar"] { margin-top: 1 }
                [foo|="bar"] { margin-bottom: 1 }
              </style>
            </head>
            <body>
              <h foo="foo"/>
              <p foo="foo"/>
              <p foo="bar"/>
              <p foo="barz"/>
              <p foo="bar-z"/>
              <p foo="bar baz"/>
              <p>foo</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <h foo="foo" style="display: block; margin-left: 1;"/>
          <p foo="foo" style="display: block;"/>
          <p foo="bar" style="display: block; margin-bottom: 1; margin-right: 1; margin-top: 1;"/>
          <p foo="barz" style="display: block;"/>
          <p foo="bar-z" style="display: block; margin-bottom: 1;"/>
          <p foo="bar baz" style="display: block; margin-top: 1;"/>
          <p>foo</p>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_07 -->
  <!-- ======= -->
  <!--
      Class selectors
  -->
  <x:scenario label="test_07">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                .foo { display: block }
                h.foo { margin-left: 1 }
              </style>
            </head>
            <body>
              <h class="foo"/>
              <p class="foo"/>
              <p class="foobar"/>
              <p class="foo bar"/>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <h class="foo" style="display: block; margin-left: 1;"/>
          <p class="foo" style="display: block;"/>
          <p class="foobar"/>
          <p class="foo bar" style="display: block;"/>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_08 -->
  <!-- ======= -->
  <!--
      ID selectors
  -->
  <x:scenario label="test_08">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                #foo { display: block }
                p#bar { margin-left: 1 }
              </style>
            </head>
            <body>
              <p id="foo"/>
              <p id="bar"/>
              <p id="baz"/>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <p id="foo" style="display: block;"/>
          <p id="bar" style="margin-left: 1;"/>
          <p id="baz"/>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_09 -->
  <!-- ======= -->
  <!--
      Pseudo classes
  -->
  <x:scenario label="test_09">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                li:first-child { margin-left: 1 }
                li:last-child { margin-right: 1 }
                li:nth-child(3) { margin-top: 1 }
                li:only-child { margin-bottom: 1 }
              </style>
            </head>
            <body>
              <ul>
                <li/>
                <li/>
                <li>
                  <ol>
                    <li/>
                  </ol>
                </li>
                <li/>
              </ul>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <ul>
            <li style="margin-left: 1;"/>
            <li/>
            <li style="margin-top: 1;">
              <ol>
                <li style="margin-bottom: 1; margin-left: 1; margin-right: 1;"/>
              </ol>
            </li>
            <li style="margin-right: 1;"/>
          </ul>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_10 -->
  <!-- ======= -->
  <!--
      Pseudo elements
  -->
  <x:scenario label="test_10">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                p::before { display: block }
                p::after { display: block }
              </style>
            </head>
            <body>
              <p>foobar</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result" select="//body"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <body>
          <p style="::before { display: block; } ::after { display: block; }">foobar</p>
        </body>
      </x:document>
    </x:expect>
  </x:scenario>
  
  <!-- ======= -->
  <!-- test_11 -->
  <!-- ======= -->
  <!--
      TODO: Root selector
  -->
  <x:scenario label="test_11" pending="failure">
    <x:call step="css:inline">
      <x:input port="source">
        <x:document type="inline">
          <document>
            <head>
              <style media="embossed" type="text/css">
                :root { display: block }
              </style>
            </head>
            <body>
              <p>foobar</p>
            </body>
          </document>
        </x:document>
      </x:input>
    </x:call>
    <x:context label="result">
      <x:document type="port" port="result"/>
    </x:context>
    <x:expect label="result" type="compare">
      <x:document type="inline">
        <document>
          <head>
            <style media="embossed" type="text/css">
              :root { display: block }
            </style>
          </head>
          <body style="display: block;">
            <p>foobar</p>
          </body>
        </document>
      </x:document>
    </x:expect>
  </x:scenario>
  
</x:description>
